CREATE TABLE STUDENTS(ROLL_NO VARCHAR(7) NOT NULL PRIMARY KEY, EMAIL VARCHAR(17) NOT NULL, TOKEN VARCHAR(50) NOT NULL);


CREATE TABLE CODES_LIST(NAME VARCHAR(40) NOT NULL, CODE VARCHAR(6) NOT NULL PRIMARY KEY);


CREATE TABLE COURSES(COURSE_CODE VARCHAR(6) NOT NULL, ROLL_NO VARCHAR(7) NOT NULL, C_SECTION VARCHAR(1) NOT NULL, INDEX(COURSE_CODE), INDEX(ROLL_NO), INDEX(C_SECTION), CONSTRAINT FK_COURSE FOREIGN KEY(ROLL_NO) REFERENCES STUDENTS(ROLL_NO) ON UPDATE CASCADE, CONSTRAINT FK_C FOREIGN KEY(COURSE_CODE) REFERENCES CODES_LIST(CODE) ON UPDATE CASCADE, CONSTRAINT PK_COURSE PRIMARY KEY(COURSE_CODE, ROLL_NO,C_SECTION));


CREATE TABLE LABS(LAB_CODE VARCHAR(6) NOT NULL, ROLL_NO VARCHAR(7) NOT NULL, L_SECTION VARCHAR(1) NOT NULL, INDEX(LAB_CODE), INDEX(ROLL_NO), INDEX(L_SECTION), CONSTRAINT FK_LAB FOREIGN KEY(ROLL_NO) REFERENCES STUDENTS(ROLL_NO) ON UPDATE CASCADE, CONSTRAINT FK_LAB2 FOREIGN KEY(LAB_CODE) REFERENCES CODES_LIST(CODE) ON UPDATE CASCADE, CONSTRAINT PK_LAB PRIMARY KEY(LAB_CODE,ROLL_NO,L_SECTION));


CREATE TABLE ASSIGNMENTS(ASSIGNMENT_NO INT(2) NOT NULL, ROLL_NO VARCHAR(7) NOT NULL, OBTAINED_MARKS INT(3) NOT NULL, CODE VARCHAR(6) NOT NULL, SUBMISSION_STATUS INT(1) NOT NULL, INDEX(ASSIGNMENT_NO), INDEX(ROLL_NO), INDEX(CODE), CONSTRAINT FK_ASSIGN FOREIGN KEY(ROLL_NO) REFERENCES STUDENTS(ROLL_NO) ON UPDATE CASCADE, CONSTRAINT FK_ASSIGN2 FOREIGN KEY(CODE) REFERENCES COURSES(COURSE_CODE) ON UPDATE CASCADE, CONSTRAINT FK_ASSIGN3 FOREIGN KEY(CODE) REFERENCES LABS(LAB_CODE) ON UPDATE CASCADE, CONSTRAINT PK_ASSIGN PRIMARY KEY(ASSIGNMENT_NO, ROLL_NO, CODE));


CREATE TABLE TASKS(TASK_NO INT(2) NOT NULL, ROLL_NO VARCHAR(7) NOT NULL, OBTAINED_MARKS INT(3) NOT NULL, LAB_CODE VARCHAR(6) NOT NULL, SUBMISSION_STATUS INT(1) NOT NULL, INDEX(TASK_NO), INDEX(ROLL_NO), INDEX(LAB_CODE), CONSTRAINT FK_TASKS FOREIGN KEY(ROLL_NO) REFERENCES STUDENTS(ROLL_NO) ON UPDATE CASCADE, CONSTRAINT FK_TASKS2 FOREIGN KEY(LAB_CODE) REFERENCES LABS(LAB_CODE) ON UPDATE CASCADE, CONSTRAINT PK_TASKS PRIMARY KEY(TASK_NO, ROLL_NO, LAB_CODE));


CREATE TABLE METADATA(ASSIGN_NO INT(2) NOT NULL, CODE VARCHAR(6) NOT NULL, SECTION VARCHAR(1) NOT NULL, DEADLINE DATE NOT NULL, MARKS INT(3) NOT NULL, INDEX(ASSIGN_NO), INDEX(CODE), INDEX(SECTION), CONSTRAINT FK_META FOREIGN KEY(ASSIGN_NO) REFERENCES ASSIGNMENTS(ASSIGNMENT_NO) ON UPDATE CASCADE, CONSTRAINT FK_META2 FOREIGN KEY(ASSIGN_NO) REFERENCES TASKS(TASK_NO) ON UPDATE CASCADE, CONSTRAINT FK_META3 FOREIGN KEY(SECTION) REFERENCES COURSES(C_SECTION) ON UPDATE CASCADE, CONSTRAINT FK_META4 FOREIGN KEY(SECTION) REFERENCES LABS(L_SECTION) ON UPDATE CASCADE, CONSTRAINT FK_META5 FOREIGN KEY(CODE) REFERENCES COURSES(COURSE_CODE) ON UPDATE CASCADE, CONSTRAINT FK_META6 FOREIGN KEY(CODE) REFERENCES LABS(LAB_CODE) ON UPDATE CASCADE, CONSTRAINT PK_META PRIMARY KEY(ASSIGN_NO,CODE,SECTION));


CREATE TABLE ADMIN(USERNAME VARCHAR(20) NOT NULL PRIMARY KEY, TOKEN VARCHAR(50) NOT NULL);


load data local infile '[filename].txt' into table [tablename] fields terminated by ',';
