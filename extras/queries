CREATE TABLE STUDENTS(STUDENT_NAME VARCHAR(30) NOT NULL, EMAIL VARCHAR(30) NOT NULL PRIMARY KEY, TOKEN VARCHAR(50) NOT NULL);


CREATE TABLE CODES_LIST(NAME VARCHAR(40) NOT NULL, CODE VARCHAR(20) NOT NULL PRIMARY KEY);


CREATE TABLE COURSES(COURSE_CODE VARCHAR(20) NOT NULL, EMAIL VARCHAR(30) NOT NULL, C_SECTION VARCHAR(1) NOT NULL, INDEX(COURSE_CODE), INDEX(EMAIL), INDEX(C_SECTION), CONSTRAINT FK_COURSE FOREIGN KEY(EMAIL) REFERENCES STUDENTS(EMAIL) ON UPDATE CASCADE, CONSTRAINT FK_C FOREIGN KEY(COURSE_CODE) REFERENCES CODES_LIST(CODE) ON UPDATE CASCADE, CONSTRAINT PK_COURSE PRIMARY KEY(COURSE_CODE, EMAIL, C_SECTION));


CREATE TABLE META_ASSIGN(ASSIGN_NO INT(2) NOT NULL, CODE VARCHAR(20) NOT NULL, DEADLINE DATETIME NOT NULL, MARKS INT(3) NOT NULL, INDEX(ASSIGN_NO), INDEX(CODE), CONSTRAINT FK_MA FOREIGN KEY(CODE) REFERENCES CODES_LIST(CODE) ON UPDATE CASCADE, CONSTRAINT PK_MA PRIMARY KEY(ASSIGN_NO,CODE));


CREATE TABLE META_TASK(TASK_NO INT(2) NOT NULL, CODE VARCHAR(20) NOT NULL, SECTION VARCHAR(1) NOT NULL, DEADLINE DATETIME NOT NULL, MARKS INT(3) NOT NULL, INDEX(TASK_NO), INDEX(CODE), INDEX(SECTION), CONSTRAINT FK_MT FOREIGN KEY(CODE) REFERENCES CODES_LIST(CODE) ON UPDATE CASCADE, CONSTRAINT PK_MT PRIMARY KEY(TASK_NO,CODE,SECTION));


CREATE TABLE ASSIGNMENTS(ASSIGNMENT_NO INT(2) NOT NULL, EMAIL VARCHAR(30) NOT NULL, OBTAINED_MARKS INT(3) NOT NULL, CODE VARCHAR(6) NOT NULL, SUBMISSION_STATUS INT(1) NOT NULL, INDEX(ASSIGNMENT_NO), INDEX(EMAIL), INDEX(CODE), CONSTRAINT FK_ASSIGN FOREIGN KEY(ASSIGNMENT_NO) REFERENCES META_ASSIGN(ASSIGN_NO) ON UPDATE CASCADE, CONSTRAINT FK_ASSIGN1 FOREIGN KEY(EMAIL) REFERENCES STUDENTS(EMAIL) ON UPDATE CASCADE, CONSTRAINT FK_ASSIGN2 FOREIGN KEY(CODE) REFERENCES CODES_LIST(CODE) ON UPDATE CASCADE, CONSTRAINT PK_ASSIGN PRIMARY KEY(ASSIGNMENT_NO, EMAIL, CODE));


CREATE TABLE TASKS(TASK_NO INT(2) NOT NULL, EMAIL VARCHAR(30) NOT NULL, OBTAINED_MARKS INT(3) NOT NULL, LAB_CODE VARCHAR(20) NOT NULL, SUBMISSION_STATUS INT(1) NOT NULL, INDEX(TASK_NO), INDEX(EMAIL), INDEX(LAB_CODE), CONSTRAINT FK_TASKS1 FOREIGN KEY(TASK_NO) REFERENCES META_TASK(TASK_NO) ON UPDATE CASCADE, CONSTRAINT FK_TASKS2 FOREIGN KEY(EMAIL) REFERENCES STUDENTS(EMAIL) ON UPDATE CASCADE, CONSTRAINT FK_TASKS3 FOREIGN KEY(LAB_CODE) REFERENCES CODES_LIST(CODE) ON UPDATE CASCADE, CONSTRAINT PK_TASKS PRIMARY KEY(TASK_NO, EMAIL, LAB_CODE));

CREATE TABLE ADMIN(EMAIL VARCHAR(25) NOT NULL PRIMARY KEY, TOKEN VARCHAR(50) NOT NULL);

CREATE TABLE STUDENTS_LIST(CODE VARCHAR(20) NOT NULL, EMAIL VARCHAR(30) NOT NULL, SECTION VARCHAR(1) NOT NULL, INDEX(CODE), INDEX(EMAIL), INDEX(SECTION), CONSTRAINT FK_SL FOREIGN KEY(EMAIL) REFERENCES STUDENTS(EMAIL) ON UPDATE CASCADE, CONSTRAINT FK_SL2 FOREIGN KEY(CODE) REFERENCES CODES_LIST(CODE) ON UPDATE CASCADE, CONSTRAINT PK_SL PRIMARY KEY(CODE,EMAIL,SECTION));

load data local infile '[filename].txt' into table [tablename] fields terminated by ',';
